<!DOCTYPE html>
  
  
  
  
   <html class="no-js"> 

  <head lang="en-us">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=1,maximum-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=10" />
    <title>MongoDb Persistence - Scalatra</title>
    <meta name="generator" content="Hugo 0.19" />

    
    <meta name="description" content="Documentation and how-to guides for the Scalatra microframework.">
    
    <link rel="canonical" href="https://scalatra.github.io/scalatra-docbuild/guides/2.3/persistence/mongodb.html">
    

    <meta property="og:url" content="https://scalatra.github.io/scalatra-docbuild/guides/2.3/persistence/mongodb.html">
    <meta property="og:title" content="Scalatra">
    <meta property="og:image" content="https://scalatra.github.io/scalatra-docbuild/images/logo.png">
    <meta name="apple-mobile-web-app-title" content="Scalatra">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

    <link rel="shortcut icon" type="image/x-icon" href="https://scalatra.github.io/scalatra-docbuild/images/favicon.ico">
    <link rel="icon" type="image/x-icon" href="https://scalatra.github.io/scalatra-docbuild/images/favicon.ico">

    <style>
      @font-face {
        font-family: 'Icon';
        src: url('https://scalatra.github.io/scalatra-docbuild/fonts/icon.eot?52m981');
        src: url('https://scalatra.github.io/scalatra-docbuild/fonts/icon.eot?#iefix52m981')
               format('embedded-opentype'),
             url('https://scalatra.github.io/scalatra-docbuild/fonts/icon.woff?52m981')
               format('woff'),
             url('https://scalatra.github.io/scalatra-docbuild/fonts/icon.ttf?52m981')
               format('truetype'),
             url('https://scalatra.github.io/scalatra-docbuild/fonts/icon.svg?52m981#icon')
               format('svg');
        font-weight: normal;
        font-style: normal;
      }
    </style>

    <link rel="stylesheet" href="https://scalatra.github.io/scalatra-docbuild/stylesheets/application.css">
    <link rel="stylesheet" href="https://scalatra.github.io/scalatra-docbuild/stylesheets/temporary.css">
    <link rel="stylesheet" href="https://scalatra.github.io/scalatra-docbuild/stylesheets/palettes.css">
    <link rel="stylesheet" href="https://scalatra.github.io/scalatra-docbuild/stylesheets/bootstrap-styles.css">
    <link rel="stylesheet" href="https://scalatra.github.io/scalatra-docbuild//stylesheets/highlight/highlight.css">

    
    
    
    <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Ubuntu:400,700|Ubuntu&#43;Mono">
    <style>
      body, input {
        font-family: 'Ubuntu', Helvetica, Arial, sans-serif;
      }
      pre, code {
        font-family: 'Ubuntu Mono', 'Courier New', 'Courier', monospace;
      }
    </style>

    
    <script src="https://scalatra.github.io/scalatra-docbuild/javascripts/modernizr.js"></script>

    

  </head>
  <body class="palette-primary-teal palette-accent-red">




<div class="backdrop">
	<div class="backdrop-paper"></div>
</div>

<input class="toggle" type="checkbox" id="toggle-drawer">
<input class="toggle" type="checkbox" id="toggle-search">
<label class="toggle-button overlay" for="toggle-drawer"></label>

<header class="header">
	<nav aria-label="Header">
  <div class="bar default">
    <div class="button button-menu" role="button" aria-label="Menu">
      <label class="toggle-button icon icon-menu" for="toggle-drawer">
        <span></span>
      </label>
    </div>
    <div class="stretch">
      <div class="title">
        MongoDb Persistence
      </div>
    </div>

    
    <div class="button button-twitter" role="button" aria-label="Twitter">
       <a href="https://twitter.com/scalatra" title="@scalatra on Twitter" target="_blank" class="toggle-button icon icon-twitter"></a>
    </div>
    

    
    <div class="button button-github" role="button" aria-label="GitHub">
      <a href="https://github.com/scalatra/scalatra" title="@scalatra/scalatra on GitHub" target="_blank" class="toggle-button icon icon-github"></a>
    </div>
    
    
        
  </div>
  <div class="bar search">
    <div class="button button-close" role="button" aria-label="Close">
      <label class="toggle-button icon icon-back" for="toggle-search"></label>
    </div>
    <div class="stretch">
      <div class="field">
        <input class="query" type="text" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck>
      </div>
    </div>
    <div class="button button-reset" role="button" aria-label="Search">
      <button class="toggle-button icon icon-close" id="reset-search"></button>
    </div>
  </div>
</nav>
</header>

<main class="main">
	<div class="drawer">
		<nav aria-label="Navigation">
  <a href="https://scalatra.github.io/scalatra-docbuild/" class="project">
    <div class="banner">
      
        <div class="logo">
          <img src="https://scalatra.github.io/scalatra-docbuild/images/logo.png">
        </div>
      
      <div class="name">
        <strong>Scalatra </strong>
        
      </div>
    </div>
  </a>

  <div class="scrollable">
    <div class="wrapper">
      
      <div class="toc">
        
        <ul>
          
          <li><a href="https://scalatra.github.io/scalatra-docbuild/getting-started/">Getting started</a></li>
          
          <li><a href="https://scalatra.github.io/scalatra-docbuild/news.html">News</a></li>
          
          <li><a href="https://scalatra.github.io/scalatra-docbuild/guides/">Documentation</a></li>
          
          <li><a href="https://scalatra.github.io/scalatra-docbuild/community/">Community</a></li>
          
          
        </ul>
        

        
        <a href="https://www.manning.com/books/scalatra-in-action" target="_blank">
          <img src="https://scalatra.github.io/scalatra-docbuild/images/book-cover.png" alt="Scalatra in Action">
        </a>
      </div>
    </div>
  </div>
</nav>

	</div>

	<article class="article">
		<div class="wrapper">
			<h1>MongoDb Persistence </h1>

			

<p><a href="http://mongodb.org">MongoDb</a> is an open-source document database, and one of the most widely deployed NoSQL databases. It is extremely easy to use with Scalatra.</p>

<p>There are multiple Scala clients for MongoDb, and they come with varying levels of complexity. Here are some of them, as listed in MongoDb&rsquo;s <a href="http://docs.mongodb.org/ecosystem/drivers/scala/">Scala Language Center</a>.</p>

<ul>
<li><a href="http://mongodb.github.io/casbah/index.html">Casbah</a></li>
<li><a href="https://www.assembla.com/wiki/show/liftweb/MongoDB">Lift-mongodb</a></li>
<li><a href="https://github.com/foursquare/rogue">Rogue</a></li>
<li><a href="https://github.com/novus/salat">Salat</a></li>
</ul>

<h2 id="getting-going-with-casbah">Getting going with Casbah</h2>

<p>MongoDb requires very little setup. Assuming you&rsquo;ve got Mongo installed already, getting it working with Scalatra is as follows.</p>

<div class="alert alert-info">
  <span class="badge badge-info"><i class="icon-flag icon-white"></i></span>
  See
  <a href="https://github.com/scalatra/scalatra-website-examples/tree/master/2.2/persistence/scalatra-casbah-example">scalatra-casbah-example</a>
  for a minimal and standalone project containing the example in this guide.
</div>

<p>We&rsquo;ll use the officially-supported Casbah library, but any of the others should work in basically the same way.</p>

<h3 id="dependencies">Dependencies</h3>

<p>To make the following example codes work, add the following dependencies to your
<code>project/build.scala</code>:</p>

<pre><code>&quot;org.mongodb&quot; %% &quot;casbah&quot; % &quot;2.7.2&quot;,
&quot;org.json4s&quot; %% &quot;json4s-jackson&quot; % &quot;3.2.10&quot;,
&quot;org.json4s&quot; %% &quot;json4s-mongo&quot; % &quot;3.2.10&quot;,
</code></pre>

<h3 id="setup-in-scalatrabootstrap">Setup in ScalatraBootstrap</h3>

<p>First, make sure you start a connection to MongoDb when your application initializes. You do this by putting a bit of code in your <code>init</code> method in <code>src/main/scala/ScalatraBootstrap</code>:</p>

<pre><code class="language-scala">import com.mongodb.casbah.Imports._
import org.scalatra.example._
import org.scalatra._
import javax.servlet.ServletContext

class ScalatraBootstrap extends LifeCycle {
  override def init(context: ServletContext) {

     // As you can see, there's not much to do in order to get MongoDb working with Scalatra.
     // We're connecting with default settings - localhost on port 27017 -
     // by calling MongoClient() with no arguments.
    val mongoClient =  MongoClient()
    val mongoColl = mongoClient(&quot;casbah_test&quot;)(&quot;test_data&quot;)

    // pass a reference to the Mongo collection into your servlet when you mount it at application start:
    context.mount(new MongoController(mongoColl), &quot;/*&quot;)

  }
}
</code></pre>

<p>The <code>mongoColl</code> parameter in <code>context.mount(new MongoController(mongoColl), &quot;/*&quot;)</code> passes a reference to the MongoDb collection to your controller. At that point, you&rsquo;re more or less ready to start working with MongoDb in your application. A controller which does some very simple MongoDb operations might look like this:</p>

<pre><code class="language-scala">package org.scalatra.example

import org.scalatra._

// MongoDb-specific imports
import com.mongodb.casbah.Imports._

class MongoController(mongoColl: MongoCollection) extends ScalatraCasbahExampleStack {

  /**
   * Insert a new object into the database. You can use the following from your console to try it out:
   * curl -i -H &quot;Accept: application/json&quot; -X POST -d &quot;key=super&amp;value=duper&quot; http://localhost:8080/insert
   */
  post(&quot;/&quot;) {
    val key = params(&quot;key&quot;)
    val value = params(&quot;value&quot;)
    val newObj = MongoDBObject(key -&gt; value)
    mongoColl += newObj
  }

  /**
   * Retrieve everything in the MongoDb collection we're currently using.
   */
  get(&quot;/&quot;) {
    mongoColl.find()
    for { x &lt;- mongoColl} yield x
  }

  /**
   * Query for the first object which matches the values given. If you copy/pasted the insert example above,
   * try http://localhost:8080/query/super/duper in your browser.
   */
  get(&quot;/query/:key/:value&quot;) {
    val q = MongoDBObject(params(&quot;key&quot;) -&gt; params(&quot;value&quot;))
    for ( x &lt;- mongoColl.findOne(q) ) yield x
  }

}
</code></pre>

<p>Once you&rsquo;ve got the <code>MongoCollection</code> available inside your controller, you can use Mongo and Scalatra together seamlessly. If you would like to learn more about Casbah, proceed to the <a href="http://mongodb.github.io/casbah/tutorial.html">Casbah Tutorial</a>.</p>

<p>Alternately, you can apply the same basic techniques in order to get started with any of the Scala MongoDb libraries. Each library has its strengths and weaknesses, and the choice of which one to use will come down largely to your programming style.</p>


			<aside class="copyright" role="note">
				
				&copy; 2017 Scalatra Team &ndash;
				
				Documentation built with
				<a href="https://www.gohugo.io" target="_blank">Hugo</a>
				using the
				<a href="http://github.com/digitalcraftsman/hugo-material-docs" target="_blank">Material</a> theme.
			</aside>

			<footer class="footer">
				

			</footer>
		</div>
	</article>

	<div class="results" role="status" aria-live="polite">
		<div class="scrollable">
			<div class="wrapper">
				<div class="meta"></div>
				<div class="list"></div>
			</div>
		</div>
	</div>
</main>

<script>

  var base_url = '';
  var repo_id  = '';

</script>

<script src="https://scalatra.github.io/scalatra-docbuild/javascripts/application.js"></script>


<script>
  /* Add headers to scrollspy */
  var headers   = document.getElementsByTagName("h2");
  var scrollspy = document.getElementById('scrollspy');

  if(scrollspy) {
    if(headers.length > 0) {
      for(var i = 0; i < headers.length; i++) {
        var li = document.createElement("li");
        li.setAttribute("class", "anchor");

        var a  = document.createElement("a");
        a.setAttribute("href", "#" + headers[i].id);
        a.setAttribute("title", headers[i].innerHTML);
        a.innerHTML = headers[i].innerHTML;

        li.appendChild(a)
        scrollspy.appendChild(li);
      }
    } else {
      scrollspy.parentElement.removeChild(scrollspy)
    }


    /* Add permanent link next to the headers */
    var headers = document.querySelectorAll("h1, h2, h3, h4, h5, h6");

    for(var i = 0; i < headers.length; i++) {
        var a = document.createElement("a");
        a.setAttribute("class", "headerlink");
        a.setAttribute("href", "#" + headers[i].id);
        a.setAttribute("title", "Permanent link")
        a.innerHTML = "#";
        headers[i].appendChild(a);
    }
  }
</script>



<script src="https://scalatra.github.io/scalatra-docbuild/javascripts/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
</body>
</html>

